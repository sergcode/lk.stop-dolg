"use strict";function nameFilesAttach(){String.prototype.beforeLastIndex=function(t){return this.substr(0,this.lastIndexOf(t))||this+""}}nameFilesAttach(),window.addEventListener("DOMContentLoaded",()=>{function t(t){let e;switch(t){case"jpg":case"jpeg":case"png":case"tif":case"bmp":e="task__accordion_item__purple";break;case"pdf":e="task__accordion_item__red";break;case"doc":case"docx":case"odt":case"txt":e="task__accordion_item__dark-blue";break;case"xls":case"xlsx":e="task__accordion_item__green";break;case"ppt":case"pptx":e="task__accordion_item__orange";break;case"rar":case"zip":case"7z":case"tar":case"arj":case"jar":e="task__accordion_item__gold";break;default:e="task__accordion_item__neutral"}return e}function e(t,e,a){const c=document.createElement("div");return c.classList.add("attach__file","attach__item--attached"),c.innerHTML=`\t\n\t\t\t<div class="attach__file_wrapper ${a}">\n\t\t\t\t<p>${e}</p>\n\t\t\t\t<div class="attach__name">${t}</div>\n\t\t\t</div>\n\t\t  <button class="attach__delete" title="Удалить файл" role="button"></button>\n\t\t`,c}const a=t=>{t.sort()};let c=[];function n(t,e,a){e.css("max-height",a.outerHeight()),t.css("max-height",t.outerHeight()+e.outerHeight())}function s(t,e,a){$.each($(".attach__wrapper-created-files"),(s,i)=>{const o=$(i).find(".attach__delete");$.each(o,(t,e)=>{$(e).on("click",function(e){e.preventDefault();const a=$(this).closest(".attach__file"),n=a.closest(".task__accordion_item--buttons");a.remove(),c.splice(t,1),$(i).children().length<=0&&(c=[],n.find('[name="taskAccordionAttach"]').attr("disabled","disabled"))})}),e.outerHeight()>a.outerHeight()&&n(t,e,a)})}!function(i){i.each(i(".attach__input"),(o,r)=>{i(r).change(function(o){o.preventDefault();const r=i(this),_=r.closest(".task__accordion_item--more-info"),d=_.closest(".task__accordion_wrapper"),l=_.find(".task__accordion_item--more-wrapper"),h=l.find(".attach__wrapper-created-files");!function(n,s){for(let i=0;i<n[0].files.length;i++){let o=n[0].files[i].name,r=o.beforeLastIndex("."),_=o.split(".").pop();c.push(o),a(c),s.append(e(r,_,t(_)))}}(r,h),s(d,_,l),n(d,_,l),h.children().length>0&&l.find('[name="taskAccordionAttach"]').removeAttr("disabled")})})}(jQuery)});