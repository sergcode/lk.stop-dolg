"use strict";!function(e){"function"!=typeof e.matches&&(e.matches=e.msMatchesSelector||e.mozMatchesSelector||e.webkitMatchesSelector||function(e){for(var t=this,o=(t.document||t.ownerDocument).querySelectorAll(e),s=0;o[s]&&o[s]!==t;)++s;return Boolean(o[s])}),"function"!=typeof e.closest&&(e.closest=function(e){for(var t=this;t&&1===t.nodeType;){if(t.matches(e))return t;t=t.parentNode}return null})}(window.Element.prototype),window.addEventListener("DOMContentLoaded",function(){const e=document.querySelectorAll(".js-open-modal"),t=document.querySelector(".js-overlay-modal"),o=document.querySelectorAll(".js-modal-close"),s=document.querySelector("button.tab__button[data-modal]"),c=document.querySelector('input[name="rating"]');function a(e,o,s){e.forEach(e=>{e.addEventListener("click",function(){const e=this.closest(".toggle-modal");e.classList.add("remove"),t.classList.add("remove"),r(e,s,o)})})}function n(e,o,s){t.addEventListener("click",()=>{e.classList.add("remove"),t.classList.add("remove"),r(e,s,o)})}function l(e,o,s){document.body.addEventListener("keyup",c=>{"Escape"===c.key&&(e.classList.add("remove"),t.classList.add("remove"),r(e,o,s))})}function r(e,o,s){setTimeout(()=>{e.classList.remove("active"),e.classList.remove("remove"),t.classList.remove("active"),t.classList.remove("remove"),i(),s&&(o.removeAttribute("style"),s.removeAttribute("style"))},300)}function i(){s&&(s.onclick=(()=>{s.classList.add("active")}),s.classList.remove("active"))}e.forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();let s=this.getAttribute("data-modal"),r=document.querySelector('.toggle-modal[data-modal="'+s+'"]');const i=r.querySelector(".form-modal");if(r.classList.add("active"),t.classList.add("active"),r.classList.contains("active")){if(i){const e=i.querySelector("select"),t=i.querySelector(".jq-selectbox"),s=i.querySelector(".jq-selectbox__select"),d=i.querySelector("textarea"),u=i.querySelector(".form-modal__tooltip"),m=i.querySelector(".form-modal__tooltip span"),v=i.querySelector(".attach__wrapper-created-files"),f=i.querySelector(".js-open-modal-success-unsuccess");!function(e,t){e&&(e.onchange=function(){"Не выбрана"===this.value&&"Не выбран"===this.value||!t.getAttribute("style")||t.removeAttribute("style")})}(e,s),d&&(d.addEventListener("input",function(){m.innerText=this.value.length,d.value.length>=5&&(u.removeAttribute("style"),d.removeAttribute("style"))}),f.addEventListener("click",function(o){o.preventDefault();let a=this.getAttribute("data-modal"),l=document.querySelector('.toggle-modal__successfully[data-modal="'+a+'"]');if(e&&("Не выбрана"==e.value||"Не выбран"==e.value))return s.style.cssText="border: 1px solid #fe4f3e;",!1;if(d.value.length>=5){r.classList.add("remove"),setTimeout(()=>{r.classList.remove("active"),r.classList.remove("remove"),l.classList.add("active"),i.reset(),function(e,t,o){e&&t.classList.contains("changed")&&(t.classList.remove("changed"),o.querySelector(".jq-selectbox__select-text").innerText=e.value)}(e,t,s),function(e){if(e&&e.childElementCount>0)for(;e.firstChild;)e.removeChild(e.firstChild)}(v)},300),n(l,"",""),setTimeout(()=>{d.value="",m.innerText="0",c.checked=!1},1e3);let o=new FormData;o.append("action","sendRating"),o.append("rating",$("input[name=rating]:checked").val()),o.append("message",$("#formModalComment").val()),fetch("/assets/ajax.php",{method:"POST",body:o}).then(function(e){if(200===e.status)return e.json()})}else u.style.cssText="\n                visibility: visible; \n                opacity: 1;\n                bottom: 0",d.style.cssText="border: 1px solid #fe4f3e;"})),a(o,d,u),n(r,d,u),l(r,d,u)}a(o,"",""),n(r,"",""),l(r,"","")}})}),i()});