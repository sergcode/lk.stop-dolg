{"version":3,"sources":["attach.js"],"names":["$","document","ready","each","attach","fieldClass","attachedClass","fields","find","length","fieldsAttached","newItem","on","e","item","closest","fileName","target","value","split","pop","text","hasClass","addClass","after","remove","replaceWith","html"],"mappings":"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","sourcesContent":["$(document).ready(function () {\r\n  $('.attach').each(function() { // на случай, если таких групп файлов будет больше одной\r\n    var attach = $(this),\r\n        fieldClass = 'attach__item', // класс поля\r\n        attachedClass = 'attach__item--attached', // класс поля с файлом\r\n        fields = attach.find('.' + fieldClass).length, // начальное кол-во полей\r\n        fieldsAttached = 0; // начальное кол-во полей с файлами\r\n\r\n    var newItem = '<div class=\"attach__item\"><label class=\"attach__button\"><span class=\"attach__up button button__little button--green\" role=\"button\"><img src=\"/images/tasks/add.svg\" alt=\"\">Загрузить ещё</span><input class=\"attach__input\" type=\"file\" name=\"files[]\" accept=\"image/*\"/></label><div class=\"attach__name\"></div><div class=\"attach__delete\"><a title=\"Удалить\"><img src=\"/images/tasks/delete.svg\" alt=\"Удалить\"></a></div></div>'; // разметка нового поля\r\n\r\n    // При изменении инпута\r\n    attach.on('change', '.attach__input', function(e) {\r\n      var item = $(this).closest('.' + fieldClass),\r\n          fileName = '';\r\n      if (e.target.value) { // если value инпута не пустое\r\n        fileName = e.target.value.split('\\\\').pop(); // оставляем только имя файла и записываем в переменную\r\n      }\r\n      if (fileName) { // если имя файла не пустое\r\n        item.find('.attach__name').text(fileName); // подставляем в поле имя файла\r\n        if (!item.hasClass(attachedClass)) { // если в поле до этого не было файла\r\n          item.addClass(attachedClass); // отмечаем поле классом\r\n          fieldsAttached++;\r\n        }\r\n        if (fields == fieldsAttached) { // если полей меньше 10 и кол-во полей равно\r\n          item.after($(newItem)); // добавляем новое поле\r\n          fields++;\r\n        }\r\n      } else { // если имя файла пустое\r\n        if (fields == fieldsAttached + 1) {\r\n          item.remove(); // удаляем поле\r\n          fields--;\r\n        } else {\r\n          item.replaceWith($(newItem)); // заменяем поле на \"чистое\"\r\n        }\r\n        fieldsAttached--;\r\n\r\n        if (fields == 1) { // если поле осталось одно\r\n          attach.find('.attach__up').text('Загрузить файл'); // меняем текст\r\n        }\r\n      }\r\n    });\r\n\r\n    // При нажатии на \"Удалить\"\r\n    attach.on('click', '.attach__delete', function() {\r\n      var item = $(this).closest('.' + fieldClass);\r\n      if (fields > fieldsAttached) { // если полей больше, чем загруженных файлов\r\n        item.remove(); // удаляем поле\r\n        fields--;\r\n      } else { // если равно\r\n        item.after($(newItem)); // добавляем новое поле\r\n        item.remove(); // удаляем старое\r\n      }\r\n      fieldsAttached--;\r\n      if (fields == 1) { // если поле осталось одно\r\n        attach.find('.attach__up').html('<img src=\"/images/tasks/add.svg\" alt=\"\">Загрузить файл'); // меняем текст\r\n      }\r\n    });\r\n  });\r\n})\r\n"],"file":"attach.js"}